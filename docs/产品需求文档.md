# 每日励志语录系统 - 产品需求文档 (PRD)

## 1. 项目概述

### 1.1 项目名称
每日励志语录生成系统（Daily Motivation Quote System）

### 1.2 项目背景
通过结合用户个人信息、实时日期、天气、心情等多维度因素，利用AI技术为用户生成个性化的每日励志语录，提供情感支持和正能量鼓励。

### 1.3 项目目标
- 为用户提供个性化、情境化的每日励志内容
- 打造独特的中国风暗黑美学视觉体验
- 通过AI技术实现智能化内容生成
- 提升用户每日访问粘性和情感连接

### 1.4 目标用户
- 需要情感支持和正能量的都市人群
- 喜欢中国风美学和个性化内容的用户
- 追求生活仪式感的年轻用户群体

---

## 2. 功能需求

### 2.1 用户注册模块

#### 2.1.1 功能描述
用户首次访问时需要完成注册，建立个人档案。

#### 2.1.2 输入字段
| 字段名 | 类型 | 是否必填 | 验证规则 | 说明 |
|--------|------|----------|----------|------|
| 姓名 | 文本 | 是 | 2-20字符 | 用于个性化称呼 |
| 生日 | 日期 | 是 | YYYY-MM-DD | 用于生日祝福判断 |
| 性别 | 单选 | 是 | 男/女/其他 | 用于语录风格调整 |
| 手机号 | 文本 | 是 | 11位数字 | 作为登录账号 |
| 密码 | 密码 | 是 | 8-20位，包含字母数字 | 登录凭证 |

#### 2.1.3 验证规则
- 手机号唯一性验证（不可重复注册）
- 密码强度验证（至少包含字母和数字）
- 年龄验证（根据生日计算，需满18岁）

#### 2.1.4 交互流程
1. 用户填写注册表单
2. 前端实时验证输入格式
3. 提交后后端验证数据有效性
4. 注册成功后自动跳转到登录页面

---

### 2.2 用户登录模块

#### 2.2.1 功能描述
已注册用户通过手机号和密码登录系统。

#### 2.2.2 输入字段
- 手机号（必填）
- 密码（必填）

#### 2.2.3 交互流程
1. 用户输入手机号和密码
2. 后端验证凭证有效性
3. 登录成功后生成JWT Token
4. 跳转到主页面（语录生成页面）

#### 2.2.4 错误处理
- 账号不存在提示："该手机号未注册"
- 密码错误提示："密码错误，请重试"
- 连续失败3次锁定10分钟

---

### 2.3 每日语录生成模块

#### 2.3.1 功能描述
这是系统的核心功能，根据多维度信息生成个性化励志语录。

#### 2.3.2 页面布局
```
+------------------------------------------+
|            用户头像区域                   |
|         （显示姓名、今日日期）             |
+------------------------------------------+
|                                          |
|          [点击生成今日语录] 按钮          |
|                                          |
+------------------------------------------+
|         可选输入区域                      |
|  今日大事：[___________________]         |
|  目前心情：[___________________]         |
+------------------------------------------+
|                                          |
|         语录展示区域                      |
|      （中国风画卷展开效果）                |
|      配有情绪表情图标                     |
|      水墨风格字体                         |
|                                          |
+------------------------------------------+
```

#### 2.3.3 输入参数

**必填参数（系统自动获取）：**
- 用户基本信息（姓名、性别、生日）
- 当前日期时间
- 当前天气信息
- 用户地理位置（城市）

**可选参数（用户手动输入）：**
| 字段名 | 类型 | 最大长度 | 说明 |
|--------|------|----------|------|
| 今日大事 | 文本 | 100字符 | 用户今天的重要事件 |
| 目前心情 | 文本 | 50字符 | 用户当前情绪状态 |

#### 2.3.4 AI提示词构建逻辑

系统需要构建以下结构的提示词：

```
你是一位富有情感智慧的励志导师。请根据以下信息为用户生成一句今日励志语录：

【用户信息】
- 姓名：{name}
- 性别：{gender}
- 年龄：{age}岁

【时间信息】
- 今日日期：{date}（星期{weekday}）
- 当前时间：{time}
- 特殊日期标识：{is_birthday/birthday_coming/normal_day}

【环境信息】
- 所在城市：{city}
- 当前天气：{weather}
- 气温：{temperature}

【用户状态】（如果用户填写）
- 今日大事：{event}
- 目前心情：{mood}

【输出要求】
1. 生成一句30-60字的励志语录
2. 语录需结合用户的特殊日期、天气、心情等因素
3. 风格：富有诗意、积极向上、贴近用户情境
4. 格式：直接输出语录内容，不要任何前缀、后缀或解释
5. 如果是生日或临近生日，需巧妙融入生日祝福
6. 根据天气和心情调整语录情感色调
```

#### 2.3.5 生日判断逻辑
- **当天生日**：`今日日期 == 用户生日（月日）`
  - 生成包含生日祝福的语录
- **临近生日**：`距离生日 <= 3天`
  - 生成带有期待感的语录
- **普通日期**：正常生成励志语录

#### 2.3.6 DeepSeek API调用

**请求参数：**
```json
{
  "model": "deepseek-chat",
  "messages": [
    {
      "role": "system",
      "content": "你是一位富有情感智慧的励志导师。"
    },
    {
      "role": "user",
      "content": "{构建的提示词}"
    }
  ],
  "temperature": 0.8,
  "max_tokens": 200
}
```

**响应处理：**
- 提取`choices[0].message.content`作为语录内容
- 去除可能的前后空格和换行符
- 验证长度在30-60字之间（如不符合则重试）

#### 2.3.7 情绪表情展示

根据用户输入的心情关键词，匹配对应的表情图标：

| 心情关键词 | 表情类型 | 颜色 |
|-----------|---------|------|
| 开心、快乐、高兴 | 😊 | 金色 |
| 平静、安宁、淡然 | 😌 | 青色 |
| 疲惫、累、辛苦 | 😔 | 灰色 |
| 焦虑、担心、紧张 | 😰 | 蓝色 |
| 愤怒、生气、不爽 | 😤 | 红色 |
| 伤心、难过、失落 | 😢 | 紫色 |
| 期待、兴奋、激动 | 🤩 | 橙色 |
| 默认（未填写） | 🧘 | 白色 |

---

### 2.4 天气信息获取

#### 2.4.1 数据来源
推荐使用以下天气API（按优先级）：
1. 和风天气API（免费额度充足）
2. 心知天气API
3. OpenWeatherMap API

#### 2.4.2 获取信息
- 实时天气状况（晴/雨/雪/阴/雾等）
- 实时气温
- 天气描述（如"小雨转多云"）

#### 2.4.3 用户定位
- 优先使用浏览器Geolocation API获取经纬度
- 通过IP地址反查城市（备用方案）
- 默认城市：北京（用户可手动修改）

---

## 3. 非功能需求

### 3.1 视觉设计规范

#### 3.1.1 整体风格
- **主题**：中国风暗黑美学
- **色调**：深色背景（#0a0a0a ~ #1a1a1a）
- **点缀色**：金色（#d4af37）、青色（#00ced1）、红色（#dc143c）

#### 3.1.2 字体规范
- **标题字体**：方正清刻本悦宋 / 思源宋体
- **正文字体**：站酷快乐体 / 汉仪尚巍手书
- **英文字体**：Cinzel / EB Garamond

#### 3.1.3 语录展示效果
- **画卷展开动画**：
  - 从右向左展开（3秒动画）
  - 使用CSS `clip-path` 实现
  - 配合淡入效果

- **水墨笔触**：
  - 文字逐字显示（打字机效果）
  - 字体颜色渐变（从淡到浓）
  - 背景添加水墨纹理

- **情绪表情**：
  - 位于语录左上角
  - 3D旋转入场动画
  - 发光效果（根据情绪颜色）

#### 3.1.4 禁止元素
- ❌ 可爱卡通风格
- ❌ 明亮鲜艳配色
- ❌ 圆润边角设计
- ❌ 童趣元素

---

### 3.2 性能要求

| 指标 | 目标值 |
|------|--------|
| 页���首屏加载 | < 2秒 |
| 语录生成响应 | < 5秒 |
| API调用超时 | 10秒 |
| 图片资源加载 | < 1秒 |

---

### 3.3 安全要求

#### 3.3.1 数据安全
- 密码必须加密存储（bcrypt算法）
- 使用HTTPS协议传输
- API接口需JWT Token认证

#### 3.3.2 输入验证
- 防止SQL注入（使用ORM参数化查询）
- 防止XSS攻击（输入内容转义）
- 敏感词过滤（用户输入的心情、大事）

#### 3.3.3 访问控制
- 登录态验证（Token过期7天）
- 接口请求频率限制（每分钟最多10次生成）

---

### 3.4 兼容性要求

#### 3.4.1 浏览器支持
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

#### 3.4.2 设备支持
- 桌面端（1920x1080及以上）
- 平板端（768x1024）
- 移动端（375x667及以上）

---

## 4. 用户故事

### 4.1 新用户注册
```
作为一个新用户
我想要快速注册账号
以便开始使用每日语录功能
```

**验收标准：**
- 注册表单清晰易懂
- 验证提示实时反馈
- 注册成功后自动跳转登录

---

### 4.2 每日语录生成
```
作为一个已登录用户
我想要根据今天的心情和事件生成个性化语录
以便获得情感支持和正能量
```

**验收标准：**
- 可选择性填写心情和大事
- 生成的语录贴合个人情境
- 视觉呈现具有美感和仪式感

---

### 4.3 生日特殊关怀
```
作为一个生日当天或临近生日的用户
我想要看到包含生日祝福的语录
以便感受到系统的关怀
```

**验收标准：**
- 生日当天自动识别并生成生日祝福语录
- 生日前3天有期待感的语录
- 生日语录融入年龄、人生阶段等元素

---

## 5. 数据字典

### 5.1 用户表（users）
| 字段名 | 类型 | 长度 | 可空 | 默认值 | 说明 |
|--------|------|------|------|--------|------|
| id | INT | - | 否 | 自增 | 主键 |
| phone | VARCHAR | 11 | 否 | - | 手机号（唯一索引） |
| password_hash | VARCHAR | 128 | 否 | - | 加密后的密码 |
| name | VARCHAR | 50 | 否 | - | 用户姓名 |
| gender | ENUM | - | 否 | - | 性别（male/female/other） |
| birthday | DATE | - | 否 | - | 生日 |
| created_at | DATETIME | - | 否 | NOW() | 注册时间 |
| last_login_at | DATETIME | - | 是 | NULL | 最后登录时间 |

### 5.2 语录历史表（quote_history）
| 字段名 | 类型 | 长度 | 可空 | 默认值 | 说明 |
|--------|------|------|------|--------|------|
| id | INT | - | 否 | 自增 | 主键 |
| user_id | INT | - | 否 | - | 用户ID（外键） |
| quote_content | TEXT | - | 否 | - | 语录内容 |
| event_input | VARCHAR | 200 | 是 | NULL | 用户输入的大事 |
| mood_input | VARCHAR | 100 | 是 | NULL | 用户输入的心情 |
| weather | VARCHAR | 50 | 否 | - | 当时天气 |
| temperature | INT | - | 否 | - | 当时气温 |
| city | VARCHAR | 50 | 否 | - | 所在城市 |
| is_birthday | BOOLEAN | - | 否 | false | 是否生日 |
| created_at | DATETIME | - | 否 | NOW() | 生成时间 |

---

## 6. 约束与假设

### 6.1 约束
- DeepSeek API调用需购买额度
- 天气API有调用频率限制
- 用户每天最多生成10次语录

### 6.2 假设
- 用户有稳定的网络连接
- 用户愿意授权地理位置
- 用户主要在移动端使用

---

## 7. 未来规划（V2.0）

1. **社交功能**
   - 语录分享到社交媒体
   - 好友语录墙

2. **个性化增强**
   - 记住用户偏好的语录风格
   - 学习用户情绪模式

3. **多媒体扩展**
   - 语音播报语录
   - 语录配图生成

4. **数据统计**
   - 情绪趋势分析
   - 年度报告

---

## 8. 附录

### 8.1 术语表
- **JWT**：JSON Web Token，用于身份验证
- **ORM**：对象关系映射，数据库操作框架
- **API**：应用程序编程接口

### 8.2 参考资料
- DeepSeek API文档：https://platform.deepseek.com/docs
- 和风天气API：https://dev.qweather.com/
- 中国风设计参考：故宫博物院数字文创

---

**文档版本**：V1.0
**编写日期**：2025-01-03
**编写人员**：Claude Code
**审核状态**：待审核